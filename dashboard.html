<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Friction System | Dashboard</title>
    <link rel="stylesheet" href="dashboard.css" />
  </head>
  <body>
    <div class="theme-toggle-fixed" role="group" aria-label="테마 설정">
      <span class="theme-toggle-label">다크모드</span>
      <label class="switch" aria-label="다크모드 토글">
        <input type="checkbox" id="darkModeToggle" />
        <span class="slider"></span>
      </label>
    </div>

    <div class="sidebar">
      <h2>Friction</h2>
      <nav>
        <button class="nav-btn active" data-tab="overview"><span>&#128202;</span> Overview</button>
        <button class="nav-btn" data-tab="detailed-recap"><span>&#128197;</span> Detailed Recap</button>
        <button class="nav-btn" data-tab="blocklist"><span>&#128683;</span> 차단 관리</button>
        <button class="nav-btn" data-tab="settings"><span>&#9881;</span> 필터 설정</button>
        <button class="nav-btn" data-tab="schedule"><span>&#9200;</span> 스케줄</button>
      </nav>
    </div>

    <div class="main-content">
      <section id="overview" class="tab-content active">
        <header>
          <h1>사용 개요</h1>
          <p>오늘 가장 많은 시간을 보낸 사이트를 확인하고, 필요하면 차단 목록에 추가해 보세요.</p>
        </header>

        <div class="card" style="padding: 10px 24px">
          <div class="recap-mode-toggle">
            <button id="toggleRecapMode">백그라운드 보기</button>
            <div class="sort-options">
              <button id="sortByTime" class="active">시간 순</button>
              <button id="sortByVisits">방문 순</button>
            </div>
          </div>
        </div>

        <div class="recap-header">
          <h3 id="recapModeTitle">백그라운드(Active) 시간</h3>
        </div>

        <div class="recap-list" id="recapList"></div>
      </section>

      <section id="detailed-recap" class="tab-content">
        <header>
          <h1>상세 리캡</h1>
          <p>일간/주간 사용 시간과 차단 비중을 그래프로 확인해 보세요.</p>
        </header>

        <div class="card" style="padding: 10px 24px">
          <div class="recap-mode-toggle">
            <div class="sort-options">
              <button id="toggleDaily" class="active">일간 분석</button>
              <button id="toggleWeekly">주간 분석</button>
            </div>
          </div>
        </div>

        <div class="detailed-analysis active" id="dailyAnalysis">
          <input type="date" id="dailyDate" class="date-input" />
          <div class="summary-cards">
            <div class="summary-card">총 사용 시간: <span id="dailyTotal">0초</span></div>
            <div class="summary-card">차단 시간: <span id="dailyBlocked">0초</span></div>
            <div class="summary-card change-card">전일 대비 <span id="dailyChange"></span></div>
          </div>
          <div class="chart-header">
            <div class="chart-legend" aria-label="그래프 범례">
              <span class="legend-item"><span class="legend-swatch swatch-total"></span>사용 시간</span>
              <span class="legend-item"><span class="legend-swatch swatch-blocked"></span>차단(마찰) 시간</span>
            </div>
            <div class="chart-insight" id="dailyInsight"></div>
          </div>
          <div class="graph-container" id="dailyGraph"></div>
          <div class="graph-label">시간 (0h - 23h)</div>
        </div>

        <div class="detailed-analysis" id="weeklyAnalysis">
          <div class="summary-cards">
            <div class="summary-card">총 사용 시간: <span id="weeklyTotal">0초</span></div>
            <div class="summary-card">차단 시간: <span id="weeklyBlocked">0초</span></div>
            <div class="summary-card change-card">전주 대비 <span id="weeklyChange"></span></div>
          </div>
          <div class="chart-header">
            <div class="chart-legend" aria-label="그래프 범례">
              <span class="legend-item"><span class="legend-swatch swatch-total"></span>사용 시간</span>
              <span class="legend-item"><span class="legend-swatch swatch-blocked"></span>차단(마찰) 시간</span>
            </div>
            <div class="chart-insight" id="weeklyInsight"></div>
          </div>
          <div class="graph-container" id="weeklyGraph"></div>
          <div class="graph-label">요일 (월-일)</div>
        </div>
      </section>

      <section id="blocklist" class="tab-content">
        <header>
          <h1>차단 관리</h1>
          <p>방해되는 사이트 도메인을 등록하면 마찰 필터가 자동 적용돼요.</p>
        </header>

        <div class="card block-add-panel">
          <input type="text" id="newBlockUrl" placeholder="차단할 도메인 입력 (예: youtube.com)" />
          <button id="addBlockBtn" class="primary-btn">차단 추가</button>
        </div>

        <ul class="block-list" id="blockedListDisplay"></ul>
      </section>

      <section id="settings" class="tab-content">
        <header>
          <h1>필터 설정</h1>
          <p>미디어/텍스트/지연 필터를 분리해서 원하는 강도로 조절해 보세요.</p>
        </header>

        <div class="card settings-subtabs" role="tablist" aria-label="필터 설정 분류" style="margin-bottom: 16px">
          <button type="button" class="settings-subtab-btn is-active" data-settings-subtab="media" role="tab" aria-selected="true">미디어 필터</button>
          <button type="button" class="settings-subtab-btn" data-settings-subtab="text" role="tab" aria-selected="false">텍스트 필터</button>
          <button type="button" class="settings-subtab-btn" data-settings-subtab="delay" role="tab" aria-selected="false">지연 필터</button>
        </div>

        <div class="card settings-preview" id="settingsPreview" style="margin-bottom: 16px">
          <div class="settings-preview-header">
            <div class="settings-preview-title">
              <h3 style="margin: 0">예시 미리보기</h3>
              <p id="settingsPreviewDescription" style="margin: 6px 0 0; color: var(--text-muted); font-size: 13px"></p>
            </div>
          </div>
          <div class="settings-preview-grid">
            <div class="preview-col">
              <div class="preview-col-label">Before</div>
              <div class="preview-frame" id="previewBefore"></div>
            </div>
            <div class="preview-col">
              <div class="preview-col-label">After</div>
              <div class="preview-frame" id="previewAfter"></div>
            </div>
          </div>
        </div>

        <div class="settings-grid" id="settingsGrid"></div>

        <div class="card" style="margin-top: 20px">
          <button id="saveSettingsBtn" class="primary-btn">설정 저장</button>
          <span id="saveStatus" class="save-status"></span>
        </div>
      </section>

      <section id="schedule" class="tab-content">
        <header>
          <h1>스케줄</h1>
          <p>특정 시간에만 마찰 필터가 작동하도록 설정할 수 있어요.</p>
        </header>

        <div class="card schedule-panel">
          <label class="switch-label" style="display: flex; justify-content: space-between; align-items: center">
            <span>스케줄 기반 필터 활성화</span>
            <label class="switch">
              <input type="checkbox" id="schedule-toggle" />
              <span class="slider"></span>
            </label>
          </label>
        </div>

        <div class="card time-slider-container" id="time-slider-container">
          <div class="time-display">
            <span id="start-time-display">00:00</span>
            <span class="separator">~</span>
            <span id="end-time-display">24:00</span>
          </div>
          <div class="slider-track-wrapper">
            <div class="slider-track"></div>
            <div class="slider-range" id="slider-range"></div>
            <div class="slider-handle" id="handle-start"></div>
            <div class="slider-handle" id="handle-end"></div>
          </div>
        </div>
      </section>
    </div>

    <script src="dataManager.js" type="module"></script>
    <script src="config.js" type="module"></script>
    <script src="dashboard.js" type="module"></script>
  </body>
</html>
